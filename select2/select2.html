<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>demo</title>
    <link rel="stylesheet" href="bootstrap.css"/>
    <link rel="stylesheet" href="select2-3.4.5/select2-bootstrap.css"/>
    <link rel="stylesheet" href="select2-3.4.5/select2.css"/>
    <script src="jquery-1.7.1.min.js"></script>
    <script src="select2-3.4.5/select2.js"></script>
    <script src="select2-3.4.5/select2_locale_zh-CN.js"></script>
    <style>
        .w100 {
            width: 300px;
        }
        .red {
            color: red;
        }
    </style>
</head>
<body>
<!--<input type="text" id="ex1"/>-->
<select name="ex1" id="ex1" class="w100">
    <!--<option value="1">1</option>-->
    <!--<option value="2">2</option>-->
    <!--<option value="3">3</option>-->
</select>
<input type="text" id="e10" class="w100" tabindex="-1" title="">
<input type="text" id="e7" class="w100" tabindex="-1" title="" style="width: 600px">
<select id="e4" style="width: 300px;" class="populate" tabindex="-1" title="">
    <optgroup label="Alaskan/Hawaiian Time Zone">
        <option value="AK" class="red">Alaska</option>
        <option value="HI">Hawaii</option>
    </optgroup>
    <optgroup label="Pacific Time Zone">
        <option value="CA">California</option>
        <option value="NV">Nevada</option>
        <option value="OR">Oregon</option>
        <option value="WA">Washington</option>
    </optgroup>
    <optgroup label="Mountain Time Zone">
        <option value="AZ">Arizona</option>
        <option value="CO">Colorado</option>
        <option value="ID">Idaho</option>
        <option value="MT">Montana</option><option value="NE">Nebraska</option>
        <option value="NM">New Mexico</option>
        <option value="ND">North Dakota</option>
        <option value="UT">Utah</option>
        <option value="WY">Wyoming</option>
    </optgroup>
    <optgroup label="Central Time Zone">
        <option value="AL">Alabama</option>
        <option value="AR">Arkansas</option>
        <option value="IL">Illinois</option>
        <option value="IA">Iowa</option>
        <option value="KS">Kansas</option>
        <option value="KY">Kentucky</option>
        <option value="LA">Louisiana</option>
        <option value="MN">Minnesota</option>
        <option value="MS">Mississippi</option>
        <option value="MO">Missouri</option>
        <option value="OK">Oklahoma</option>
        <option value="SD">South Dakota</option>
        <option value="TX">Texas</option>
        <option value="TN">Tennessee</option>
        <option value="WI">Wisconsin</option>
    </optgroup>
    <optgroup label="Eastern Time Zone">
        <option value="CT">Connecticut</option>
        <option value="DE">Delaware</option>
        <option value="FL">Florida</option>
        <option value="GA">Georgia</option>
        <option value="IN">Indiana</option>
        <option value="ME">Maine</option>
        <option value="MD">Maryland</option>
        <option value="MA">Massachusetts</option>
        <option value="MI">Michigan</option>
        <option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
        <option value="NY">New York</option>
        <option value="NC">North Carolina</option>
        <option value="OH">Ohio</option>
        <option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option>
        <option value="VT">Vermont</option><option value="VA">Virginia</option>
        <option value="WV">West Virginia</option>
    </optgroup>
</select>
<script>
    $(function() {
        $('#ex1').select2({
            placeholder: "Select a State",
            allowClear: true
        });
    });

    $("#e10").select2({
        tags:[{id:0,text:'enhancement'},{id:1,text:'bug'},{id:2,text:'duplicate'},{id:3,text:'invalid'},{id:4,text:'wontfix'}],
//        tags: true,
        placeholder: "Search for a repository",
        maximumSelectionSize: 1
    });

    var data=[{id:0,tag:'enhancement'},{id:1,tag:'bug'},{id:2,tag:'duplicate'},{id:3,tag:'invalid'},{id:4,tag:'wontfix'}];
    function format(item) { return item.tag; }

    $("#e10_2").select2({
        data:{ results: data, text: 'tag' },
        formatSelection: format,
        formatResult: format
    });

    $("#e10_3").select2({
        data:{ results: data, text: function(item) { return item.tag; } },
        formatSelection: format,
        formatResult: format
    });
    $("#e10_4").select2({
        data:function() { return { text:'tag', results: data }; },
        formatSelection: format,
        formatResult: format
    });
    var mock;
    $("#e7").select2({
        ajax: {
            url: "https://api.github.com/search/repositories",
            dataType: 'json',
            quietMillis: 250,
            data: function (term, page) { // page is the one-based page number tracked by Select2
                mock = term;
                return {
                    q: term, //search term
                    page: page // page number
                };
            },
            results: function (data, page, query) {
                var more = (page * 30) < data.total_count; // whether or not there are more results available
                console.log(arguments);
                !data.total_count && data.items.unshift({"id":37950012,"name":"234","full_name":mock,"owner":{"login":"stefanbund","id":1642220,"avatar_url":"https://avatars.githubusercontent.com/u/1642220?v=3","gravatar_id":"","url":"https://api.github.com/users/stefanbund","html_url":"https://github.com/stefanbund","followers_url":"https://api.github.com/users/stefanbund/followers","following_url":"https://api.github.com/users/stefanbund/following{/other_user}","gists_url":"https://api.github.com/users/stefanbund/gists{/gist_id}","starred_url":"https://api.github.com/users/stefanbund/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefanbund/subscriptions","organizations_url":"https://api.github.com/users/stefanbund/orgs","repos_url":"https://api.github.com/users/stefanbund/repos","events_url":"https://api.github.com/users/stefanbund/events{/privacy}","received_events_url":"https://api.github.com/users/stefanbund/received_events","type":"User","site_admin":false},"private":false,"html_url":"https://github.com/stefanbund/234","description":"CIS 234 at Cal State Polytechnic University, Pomona, CA","fork":false,"url":"https://api.github.com/repos/stefanbund/234","forks_url":"https://api.github.com/repos/stefanbund/234/forks","keys_url":"https://api.github.com/repos/stefanbund/234/keys{/key_id}","collaborators_url":"https://api.github.com/repos/stefanbund/234/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/stefanbund/234/teams","hooks_url":"https://api.github.com/repos/stefanbund/234/hooks","issue_events_url":"https://api.github.com/repos/stefanbund/234/issues/events{/number}","events_url":"https://api.github.com/repos/stefanbund/234/events","assignees_url":"https://api.github.com/repos/stefanbund/234/assignees{/user}","branches_url":"https://api.github.com/repos/stefanbund/234/branches{/branch}","tags_url":"https://api.github.com/repos/stefanbund/234/tags","blobs_url":"https://api.github.com/repos/stefanbund/234/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/stefanbund/234/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/stefanbund/234/git/refs{/sha}","trees_url":"https://api.github.com/repos/stefanbund/234/git/trees{/sha}","statuses_url":"https://api.github.com/repos/stefanbund/234/statuses/{sha}","languages_url":"https://api.github.com/repos/stefanbund/234/languages","stargazers_url":"https://api.github.com/repos/stefanbund/234/stargazers","contributors_url":"https://api.github.com/repos/stefanbund/234/contributors","subscribers_url":"https://api.github.com/repos/stefanbund/234/subscribers","subscription_url":"https://api.github.com/repos/stefanbund/234/subscription","commits_url":"https://api.github.com/repos/stefanbund/234/commits{/sha}","git_commits_url":"https://api.github.com/repos/stefanbund/234/git/commits{/sha}","comments_url":"https://api.github.com/repos/stefanbund/234/comments{/number}","issue_comment_url":"https://api.github.com/repos/stefanbund/234/issues/comments{/number}","contents_url":"https://api.github.com/repos/stefanbund/234/contents/{+path}","compare_url":"https://api.github.com/repos/stefanbund/234/compare/{base}...{head}","merges_url":"https://api.github.com/repos/stefanbund/234/merges","archive_url":"https://api.github.com/repos/stefanbund/234/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/stefanbund/234/downloads","issues_url":"https://api.github.com/repos/stefanbund/234/issues{/number}","pulls_url":"https://api.github.com/repos/stefanbund/234/pulls{/number}","milestones_url":"https://api.github.com/repos/stefanbund/234/milestones{/number}","notifications_url":"https://api.github.com/repos/stefanbund/234/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/stefanbund/234/labels{/name}","releases_url":"https://api.github.com/repos/stefanbund/234/releases{/id}","created_at":"2015-06-23T23:09:59Z","updated_at":"2015-07-03T02:33:22Z","pushed_at":"2015-07-17T02:58:19Z","git_url":"git://github.com/stefanbund/234.git","ssh_url":"git@github.com:stefanbund/234.git","clone_url":"https://github.com/stefanbund/234.git","svn_url":"https://github.com/stefanbund/234","homepage":null,"size":476,"stargazers_count":2,"watchers_count":2,"language":"Java","has_issues":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":4,"mirror_url":null,"open_issues_count":0,"forks":4,"open_issues":0,"watchers":2,"default_branch":"master","score":37.378296});
                // notice we return the value of more so Select2 knows if more results can be loaded
                return { results: data.items, more: more };
            }
        },
        placeholder: "Search for a repository",
        minimumInputLength: 3,
        multiple: true,
        maximumSelectionSize: 1,
        formatResult: repoFormatResult, // omitted for brevity, see the source of this page
        formatSelection: repoFormatSelection, // omitted for brevity, see the source of this page
        dropdownCssClass: "bigdrop", // apply css that makes the dropdown taller
        escapeMarkup: function (m) { return m; } // we do not want to escape markup since we are displaying html in results
    });




    function repoFormatResult(repo) {
        var markup = '<div class="row-fluid">' +
                '<div class="span2"><img src="' + repo.owner.avatar_url + '" /></div>' +
                '<div class="span10">' +
                '<div class="row-fluid">' +
                '<div class="span6">' + repo.full_name + '</div>' +
                '<div class="span3"><i class="fa fa-code-fork"></i> ' + repo.forks_count + '</div>' +
                '<div class="span3"><i class="fa fa-star"></i> ' + repo.stargazers_count + '</div>' +
                '</div>';

        if (repo.description) {
            markup += '<div>' + repo.description + '</div>';
        }

        markup += '</div></div>';

        return markup;
    }

    function repoFormatSelection(repo) {
        return repo.full_name;
    }

    function format(state) {
        console.log(state)
        if (!state.id) return ''; // optgroup
        return "<img class='flag' src='images/flags/" + state.id.toLowerCase() + ".png'/>" + state.text;
    }
    $("#e4").find('optgroup option:first-child').addClass('red');
    $("#e4").find('optgroup option').appendTo($("#e4"))
    $("#e4").select2();
</script>
</body>
</html>